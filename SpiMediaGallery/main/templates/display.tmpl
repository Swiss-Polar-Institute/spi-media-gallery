{% extends 'base.tmpl' %}
{% load leaflet_tags %}
{% block title %}SPI Media Gallery - Display media{% endblock %}

{% block extra_head %}
    {% leaflet_js %}
    {% leaflet_css %}
{% endblock %}

{% block body_contents %}
    <p>
        <div class="container">
            {% include "logo.tmpl" %}
            <p></p>
            <b>{{ medium.file_name }}</b>
            <div class="row">
                <div class="col-md-6">
                    {% if medium.is_photo %}
                        <img class="img-thumbnail" src="{{ medium.small_resolution_url }}"><br>
                    {% endif %}

                    {% if medium.is_video %}
                        {% if medium.is_small_resolution_available %}
                            <div class="card p-1 {{ medium.border_color }}">
                                <div class="embed-responsive {{ medium.video_embed_responsive_ratio }}">
                                        <video controls>
                                            <source src="{{ medium.small_resolution_url }}" type="video/webm">
                                        </video>
                                </div>
                            </div>
                        {% else %}
                            <img class="img-thumbnail {{ medium.border_color }}" src="{{ medium.small_resolution_url }}"><br>
                        {% endif %}
                    {% endif %}
                    <small>
                        <br>
                        <b>Copyright:</b> {{ medium.copyright_text }}<br>
                        <b>Photographer:</b> {{ medium.photographer_name }}<br>
                        <b>License:</b> <br>
                        {{ medium.license_text | safe }}<p>
                    </small>
                    <!--
                    <div align="left">
                        <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-show-count="false">Tweet</a><script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
                    </div>
                    -->

                </div>
                <div class="col-md-6">
                    {% for photo_size in medium.list_of_resized %}
                        <a href="{{ photo_size.image_link }}">{{ photo_size.label }}</a> ({{ photo_size.resolution }}, {{ photo_size.size }})<br>
                    {% endfor %}
                    <p>
                        <a href="{{ medium.original_file_attachment_url }}">Download original file</a> ({{ medium.resolution_for_original }}, {{ medium.file_size_original }})</a>
                    <p>
                    Tags:
                        {% if medium.list_of_tags %}
                            {% for tag in medium.list_of_tags %}
                                <a href="/search/tags/?tags={{ tag.id }}">{{tag.tag}}</a>{% if not forloop.last %}, {% endif %}
                            {% endfor %}
                        {% else %}
                                none at the moment
                        {% endif %}
                    <p>

                    {% if medium.datetime_taken %}
                        Date taken: {{ medium.datetime_taken }}
                    {% else %}
                        Date taken: unknown
                    {% endif %}
                    <p>
                    {% if medium.latitude %}
                    Latitude: {{ medium.latitude|floatformat:3 }} Longitude: {{ medium.longitude|floatformat:3 }}<br>
                    <a href="/search/near?latitude={{ medium.latitude }}&longitude={{ medium.longitude }}&km=10">Nearby (10 km) photos</a>
                    {% endif %}
                    <p>
                    {% include "random_selection.tmpl" %}
                    <p>
                    {% if photo_latitude and photo_longitude %}
                        {% leaflet_map "photo_map" %}
                        <script language="javascript">
                              window.addEventListener("map:init", function (event) {
                                var map = event.detail.map;

                                var marker = L.marker([{{ photo_latitude }}, {{ photo_longitude }}]).addTo(map);
                              });
                        </script>
                    {% else %}
                        Photo without location information at the moment.
                    {% endif %}
                    <p>
                    <small>
                        Photo path: {{ medium.object_storage_key }}
                    </small>

                    </div>
            </div>
        </div>
{% endblock %}